generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

/**
 * ========== Enums ==========
 */
enum AiMode {
  ecommerce
  agente
  estetica
  appts
}

enum AgentSpecialty {
  generico
  medico
  dermatologia
  nutricion
  psicologia
  odontologia
}

enum ConversationEstado {
  pendiente
  respondido
  en_proceso
  requiere_agente
  venta_en_proceso
  venta_realizada
  agendado
  agendado_consulta
  cerrado
}

enum MessageFrom {
  client
  bot
  agent
}

enum Rol {
  admin
  agente
  invitado
}

enum Plan {
  gratis
  basic
  pro
}

enum Estado {
  inactivo
  activo
  suspendido
}

enum SubscriptionStatus {
  active
  past_due
  canceled
}

enum BillingInterval {
  monthly
}

enum PaymentStatus {
  pending
  paid
  failed
}

enum PaymentMethodType {
  card
}

enum MediaType {
  image
  video
  audio
  document
}

enum BusinessType {
  servicios
  productos
}

enum StorageProvider {
  local
  s3
  r2
  external
  cloudflare_image
}

enum AppointmentStatus {
  pending
  confirmed
  rescheduled
  cancelled
  completed
  no_show
}

enum AppointmentSource {
  ai
  agent
  client
}

enum AppointmentVertical {
  none
  salud
  bienestar
  automotriz
  veterinaria
  fitness
  otros
  odontologica
  estetica
  spa
  custom
}

enum Weekday {
  mon
  tue
  wed
  thu
  fri
  sat
  sun
}

enum StaffRole {
  profesional
  esteticista
  medico
}

/**
 * ========== Modelos base ==========
 */

model Usuario {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  rol       Rol
  empresaId Int
  empresa   Empresa  @relation(fields: [empresaId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("usuario")
}

model Empresa {
  id      Int    @id @default(autoincrement())
  nombre  String
  plan    Plan   @default(gratis)
  estado  Estado @default(inactivo)

  trialStart DateTime?
  trialEnd   DateTime?

  // Gestión de Créditos
  conversationsUsed        Int      @default(0)
  monthlyConversationLimit Int      @default(300)
  conversationsCycleStart  DateTime @default(now())

  usuarios Usuario[]

  configuracion    BusinessConfig?
  conversaciones   Conversation[]
  cuentaWhatsapp   WhatsappAccount?
  messageTemplates MessageTemplate[]

  orders Order[]

  subscriptions        Subscription[]
  paymentMethods       PaymentMethod[]
  subscriptionPayments SubscriptionPayment[]
  conversationPurchases ConversationPurchase[]

  createdAt            DateTime                @default(now())
  updatedAt            DateTime                @updatedAt
  
  // Relaciones de contenido
  Message              Message[]
  Product              Product[]
  
  // Relaciones de Agenda/Estética
  Appointment          Appointment[]
  AppointmentHour      AppointmentHour[]
  BusinessConfigAppt   BusinessConfigAppt?
  EsteticaProcedure    EsteticaProcedure[]
  ReminderRule         ReminderRule[]
  Staff                Staff[]
  AppointmentException AppointmentException[]
  Client               Client[]

  // ✨ NUEVO: Configuración de tienda E-commerce
  BusinessConfigEcommerce BusinessConfigEcommerce?

  @@map("empresa")
}

model Message {
  id             Int         @id @default(autoincrement())
  conversationId Int
  from           MessageFrom
  contenido      String      @db.Text
  timestamp      DateTime    @default(now())
  updatedAt      DateTime    @updatedAt

  // Cloud API
  externalId String?    @unique
  mediaType  MediaType?
  mediaId    String?    @db.VarChar(128)
  mediaUrl   String?    @db.Text
  mimeType   String?    @db.VarChar(64)
  caption    String?    @db.Text

  // Notas de voz
  isVoiceNote   Boolean? @default(false)
  durationSec   Int?
  transcription String?  @db.Text

  empresaId Int
  empresa   Empresa @relation(fields: [empresaId], references: [id])

  Conversation    Conversation     @relation(fields: [conversationId], references: [id])
  paymentReceipts PaymentReceipt[]

  @@unique([empresaId, externalId])
  @@index([conversationId, timestamp])
  @@index([empresaId, conversationId, timestamp])
  @@index([mediaId])
  @@index([empresaId, externalId])
  @@map("message")
}

model Conversation {
  id        Int                @id @default(autoincrement())
  phone     String
  nombre    String?
  estado    ConversationEstado @default(pendiente)
  mensajes  Message[]
  createdAt DateTime           @default(now())

  empresaId Int
  empresa   Empresa @relation(fields: [empresaId], references: [id])

  orders            Order[]
  Appointment       Appointment[]
  ConversationState ConversationState?

  @@index([empresaId, estado, createdAt])
  @@index([empresaId, phone])
  @@map("conversation")
}

model BusinessConfig {
  id        Int      @id @default(autoincrement())
  empresaId Int      @unique
  nombre    String   @default("")
  
  descripcion String? @db.Text
  servicios   String? @db.Text
  faq         String? @db.Text
  horarios    String? @db.Text
  businessType BusinessType @default(servicios)
  disclaimers String? @db.Text

  // Operación del negocio
  enviosInfo           String? @db.Text
  metodosPago          String? @db.Text
  tiendaFisica         Boolean @default(false)
  direccionTienda      String  @default("")
  politicasDevolucion  String? @db.Text
  politicasGarantia    String? @db.Text
  promocionesInfo      String? @db.Text
  canalesAtencion      String? @db.Text
  extras               String? @db.Text
  palabrasClaveNegocio String  @default("")

  // Perfil de IA
  aiMode           AiMode?
  agentSpecialty   AgentSpecialty @default(generico)
  agentPrompt      String?        @db.Text
  agentScope       String?        @db.Text
  agentDisclaimers String?        @db.Text

  // Pagos
  pagoLinkGenerico     String  @default("")
  pagoLinkProductoBase String  @default("")
  pagoNotas            String? @db.Text
  bancoNombre          String  @default("")
  bancoTitular         String  @default("")
  bancoTipoCuenta      String  @default("")
  bancoNumeroCuenta    String  @default("")
  bancoDocumento       String  @default("")
  transferenciaQRUrl   String  @default("")

  // Envíos
  envioTipo            String   @default("")
  envioEntregaEstimado String   @default("")
  envioCostoFijo       Decimal?
  envioGratisDesde     Decimal?

  // Post-venta
  facturaElectronicaInfo  String @default("")
  soporteDevolucionesInfo String @default("")

  // Escalamiento
  escalarSiNoConfia    Boolean @default(true)
  escalarPalabrasClave String  @default("")
  escalarPorReintentos Int     @default(0)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Agenda / Citas (Campos Legacy)
  appointmentEnabled   Boolean             @default(false)
  appointmentVertical  AppointmentVertical @default(none)
  appointmentTimezone  String              @default("America/Bogota")
  appointmentBufferMin Int                 @default(10)
  appointmentPolicies  String?             @db.Text
  appointmentReminders Boolean             @default(true)

  Empresa Empresa @relation(fields: [empresaId], references: [id], onDelete: Cascade)

  @@map("businessconfig")
}

model WhatsappAccount {
  id                 Int      @id @default(autoincrement())
  phoneNumberId      String   @unique @db.VarChar(64)
  wabaId             String   @db.VarChar(64)
  businessId         String?  @db.VarChar(64)
  accessToken        String   @db.Text
  displayPhoneNumber String?  @db.VarChar(32)
  empresaId          Int      @unique
  empresa            Empresa  @relation(fields: [empresaId], references: [id])
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  @@index([wabaId])
  @@map("whatsappaccount")
}

model MessageTemplate {
  id        Int      @id @default(autoincrement())
  nombre    String   @db.VarChar(100)
  idioma    String   @db.VarChar(10)
  categoria String   @db.VarChar(50)
  cuerpo    String   @db.Text
  estado    String   @default("pendiente")
  variables Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  empresaId    Int
  empresa      Empresa        @relation(fields: [empresaId], references: [id])
  ReminderRule ReminderRule[]

  @@unique([empresaId, nombre, idioma])
  @@map("messagetemplate")
}

model Product {
  id              Int      @id @default(autoincrement())
  empresaId       Int
  slug            String   @unique
  nombre          String
  descripcion     String   @default("")
  beneficios      String   @default("")
  caracteristicas String   @default("")
  precioDesde     Decimal?
  disponible      Boolean  @default(true)
  updatedAt       DateTime @updatedAt
  createdAt       DateTime @default(now())

  imagenes  ProductImage[]
  empresa   Empresa        @relation(fields: [empresaId], references: [id])
  OrderItem OrderItem[]

  @@index([empresaId, nombre])
  @@map("product")
}

model ProductImage {
  id        Int @id @default(autoincrement())
  productId Int

  imageId   String          @db.VarChar(128)
  url       String          @default("") @db.VarChar(2048)
  alt       String          @default("")
  provider  StorageProvider @default(external)
  isPrimary Boolean         @default(false)
  sortOrder Int             @default(0)

  objectKey       String?   @db.VarChar(255)
  mimeType        String?   @db.VarChar(64)
  sizeBytes       Int?
  width           Int?
  height          Int?
  whatsappMediaId String?   @db.VarChar(128)
  mediaCachedAt   DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  product Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([productId])
  @@index([provider, objectKey])
  @@index([whatsappMediaId])
  @@map("productimage")
}

/**
 * ========== Pedidos & Pagos ==========
 */
model Order {
  id             Int     @id @default(autoincrement())
  empresaId      Int
  conversationId Int
  customerPhone  String
  customerName   String?
  city           String?
  address        String?
  status         String  @default("pending")
  subtotal       Decimal @default(0)
  shippingCost   Decimal @default(0)
  total          Decimal @default(0)
  notes          String  @db.Text

  items    OrderItem[]
  payments PaymentReceipt[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  empresa      Empresa      @relation(fields: [empresaId], references: [id])
  Conversation Conversation @relation(fields: [conversationId], references: [id])

  @@index([empresaId, conversationId, status])
  @@map("order")
}

model OrderItem {
  id        Int     @id @default(autoincrement())
  orderId   Int
  productId Int
  name      String
  price     Decimal @default(0)
  qty       Int     @default(1)
  total     Decimal @default(0)

  order   Order   @relation(fields: [orderId], references: [id], onDelete: Cascade)
  product Product @relation(fields: [productId], references: [id])

  @@index([orderId])
  @@map("orderitem")
}

model PaymentReceipt {
  id         Int       @id @default(autoincrement())
  orderId    Int
  messageId  Int?
  imageUrl   String    @default("")
  amount     Decimal?
  reference  String    @default("")
  method     String    @default("")
  isVerified Boolean   @default(false)
  verifiedAt DateTime?
  rawOcrText String    @db.Text

  order   Order    @relation(fields: [orderId], references: [id], onDelete: Cascade)
  message Message? @relation(fields: [messageId], references: [id])

  createdAt DateTime @default(now())

  @@index([orderId, isVerified])
  @@map("paymentreceipt")
}

model Appointment {
  id                  Int               @id @default(autoincrement())
  empresaId           Int
  conversationId      Int?
  source              AppointmentSource @default(client)
  status              AppointmentStatus @default(pending)
  customerName        String
  customerPhone       String
  serviceName         String
  notas               String?           @db.Text
  customerDisplayName String?
  serviceDurationMin  Int?
  locationNameCache   String?
  startAt             DateTime
  endAt               DateTime
  timezone            String            @default("America/Bogota")
  procedureId         Int?
  staffId             Int?
  sendReminder24h     Boolean           @default(false)
  
  // Relaciones
  EsteticaProcedure EsteticaProcedure? @relation(name: "ProcedureToAppointments", fields: [procedureId], references: [id])
  staff             Staff?             @relation(fields: [staffId], references: [id])
  empresa           Empresa            @relation(fields: [empresaId], references: [id])
  conversation      Conversation?      @relation(fields: [conversationId], references: [id])

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  AppointmentReminderLog AppointmentReminderLog[]

  @@index([empresaId, startAt, endAt])
  @@index([empresaId, status, startAt])
  @@index([conversationId])
  @@index([empresaId, customerPhone, startAt])
  @@index([empresaId, status, startAt, customerPhone])
  @@index([deletedAt])
  @@index([empresaId, deletedAt, startAt])
  @@index([empresaId, staffId])
  @@map("appointment")
}

model AppointmentHour {
  id        Int     @id @default(autoincrement())
  empresaId Int
  day       Weekday
  isOpen    Boolean @default(false)
  start1    String? @db.VarChar(5)
  end1      String? @db.VarChar(5)
  start2    String? @db.VarChar(5)
  end2      String? @db.VarChar(5)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  empresa   Empresa  @relation(fields: [empresaId], references: [id], onDelete: Cascade)

  @@unique([empresaId, day])
  @@index([empresaId, day])
  @@map("appointmenthour")
}

/**
 * Estetica Base de Datos
 */

model BusinessConfigAppt {
  id                          Int                 @id @default(autoincrement())
  empresaId                   Int                 @unique
  aiMode                      AiMode?
  appointmentEnabled          Boolean             @default(false)
  appointmentVertical         AppointmentVertical @default(custom)
  appointmentVerticalCustom   String?
  appointmentTimezone         String              @default("America/Bogota")
  appointmentBufferMin        Int                 @default(10)
  appointmentPolicies         String?             @db.Text
  appointmentReminders        Boolean             @default(true)
  appointmentMinNoticeHours   Int?
  appointmentMaxAdvanceDays   Int?
  allowSameDayBooking         Boolean             @default(false)
  requireClientConfirmation   Boolean             @default(true)
  cancellationAllowedHours    Int?
  rescheduleAllowedHours      Int?
  defaultServiceDurationMin   Int?
  servicesText                String?             @db.Text
  services                    Json?
  locationName                String?
  locationAddress             String?
  locationMapsUrl             String?
  parkingInfo                 String?             @db.Text
  virtualMeetingLink          String?
  instructionsArrival         String?             @db.Text
  cancellationWindowHours     Int?
  noShowPolicy                String?             @db.Text
  depositRequired             Boolean             @default(false)
  depositAmount               Decimal?            @db.Decimal(10, 2)
  maxDailyAppointments        Int?
  bookingWindowDays           Int?
  blackoutDates               Json?
  overlapStrategy             String?
  reminderSchedule            Json?
  reminderTemplateId          String?
  postBookingMessage          String?             @db.Text
  prepInstructionsPerSvc      Json?
  requireWhatsappOptIn        Boolean             @default(true)
  allowSensitiveTopics        Boolean             @default(false)
  minClientAge                Int?
  kbBusinessOverview          String?             @db.Text
  kbFAQs                      Json?
  kbServiceNotes              Json?
  kbEscalationRules           Json?
  kbDisclaimers               String?             @db.Text
  kbMedia                     Json?
  kbFreeText                  String?             @db.Text
  
  EsteticaProcedure EsteticaProcedure[]
  ReminderRule      ReminderRule[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  Empresa   Empresa  @relation(fields: [empresaId], references: [id], onDelete: Cascade)

  @@map("businessconfig_appt")
}

model EsteticaProcedure {
  id                 Int      @id @default(autoincrement())
  empresaId          Int
  configApptId       Int
  name               String
  enabled            Boolean  @default(true)
  aliases            Json?
  durationMin        Int?
  requiresAssessment Boolean  @default(false)
  priceMin           Decimal? @db.Decimal(10, 2)
  priceMax           Decimal? @db.Decimal(10, 2)
  depositRequired    Boolean  @default(false)
  depositAmount      Decimal? @db.Decimal(10, 2)
  prepInstructions   String?  @db.Text
  postCare           String?  @db.Text
  contraindications  String?  @db.Text
  notes              String?  @db.Text
  pageUrl            String?
  requiredStaffIds   Json?
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  empresa            Empresa            @relation(fields: [empresaId], references: [id], onDelete: Cascade)
  businessConfigAppt BusinessConfigAppt @relation(fields: [configApptId], references: [id], onDelete: Cascade)
  Appointment        Appointment[]      @relation(name: "ProcedureToAppointments")

  @@index([empresaId])
  @@index([configApptId])
  @@map("estetica_procedure")
}

model ReminderRule {
  id                Int             @id @default(autoincrement())
  empresaId         Int
  configApptId      Int
  active            Boolean         @default(true)
  offsetHours       Int             @default(24)
  messageTemplateId Int
  templateName      String
  templateLang      String          @default("es")
  templateParams    Json?
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt

  empresa            Empresa            @relation(fields: [empresaId], references: [id], onDelete: Cascade)
  businessConfigAppt BusinessConfigAppt @relation(fields: [configApptId], references: [id], onDelete: Cascade)
  messageTemplate    MessageTemplate    @relation(fields: [messageTemplateId], references: [id], onDelete: Restrict)
  appointmentReminderLogs AppointmentReminderLog[]

  @@index([empresaId])
  @@index([configApptId])
  @@index([messageTemplateId])
  @@map("reminder_rule")
}

model AppointmentReminderLog {
  id             Int           @id @default(autoincrement())
  appointmentId  Int
  reminderRuleId Int?
  sentAt         DateTime      @default(now())
  channel        String        @default("whatsapp")
  status         String        @default("sent")
  error          String?       @db.Text
  appointment    Appointment   @relation(fields: [appointmentId], references: [id], onDelete: Cascade)
  reminderRule   ReminderRule? @relation(fields: [reminderRuleId], references: [id])

  @@index([appointmentId])
  @@index([reminderRuleId])
  @@map("appointment_reminder_log")
}

model Staff {
  id           Int       @id @default(autoincrement())
  empresaId    Int
  name         String
  role         StaffRole @default(esteticista)
  active       Boolean   @default(true)
  availability Json?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
  empresa      Empresa   @relation(fields: [empresaId], references: [id], onDelete: Cascade)
  appointments Appointment[]

  @@index([empresaId])
  @@map("staff")
}

model AppointmentException {
  id        Int      @id @default(autoincrement())
  empresaId Int
  date      DateTime
  reason    String?
  isOpen    Boolean? @default(true)
  start1    String?  @db.VarChar(5)
  end1      String?  @db.VarChar(5)
  start2    String?  @db.VarChar(5)
  end2      String?  @db.VarChar(5)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  empresa   Empresa  @relation(fields: [empresaId], references: [id], onDelete: Cascade)

  @@index([empresaId, date])
  @@map("appointment_exception")
}

model ConversationState {
  id             Int          @id @default(autoincrement())
  conversationId Int          @unique
  data           Json
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt
  conversation   Conversation @relation(fields: [conversationId], references: [id], onDelete: Cascade)

  @@index([updatedAt])
  @@map("conversation_state")
}

model CronMeta {
  keyName String   @id @map("key_name")
  lastRun DateTime @map("last_run")

  @@map("cron_meta")
}

/**
 * ========== Subscripciones / Payments ==========
 */

model SubscriptionPlan {
  id               Int             @id @default(autoincrement())
  name             String
  code             String          @unique
  price            Decimal         @db.Decimal(10, 2)
  interval         BillingInterval @default(monthly)
  isActive         Boolean         @default(true)
  gracePeriodDays  Int             @default(2)
  monthlyCredits   Int             @default(300)
  createdAt        DateTime        @default(now())
  updatedAt        DateTime        @updatedAt
  subscriptions    Subscription[]

  @@map("subscription_plan")
}

model Subscription {
  id                   Int                 @id @default(autoincrement())
  empresaId            Int
  planId               Int
  status               SubscriptionStatus  @default(active)
  currentPeriodStart   DateTime
  currentPeriodEnd     DateTime
  cancelAtPeriodEnd    Boolean             @default(false)
  canceledAt           DateTime?
  createdAt            DateTime            @default(now())
  updatedAt            DateTime            @updatedAt
  empresa              Empresa             @relation(fields: [empresaId], references: [id], onDelete: Cascade)
  plan                 SubscriptionPlan    @relation(fields: [planId], references: [id], onDelete: Restrict)
  paymentMethods       PaymentMethod[]
  subscriptionPayments SubscriptionPayment[]

  @@index([empresaId, status])
  @@map("subscription")
}

model PaymentMethod {
  id             Int               @id @default(autoincrement())
  empresaId      Int
  subscriptionId Int?
  type           PaymentMethodType @default(card)
  wompiSourceId  String?           @unique
  wompiToken     String?           @db.VarChar(191)
  brand          String?           @db.VarChar(32)
  lastFour       String?           @db.VarChar(4)
  expMonth       String?           @db.VarChar(2)
  expYear        String?           @db.VarChar(4)
  cardHolder     String?           @db.VarChar(191)
  email          String?           @db.VarChar(191)
  status         String?           @db.VarChar(32)
  isDefault      Boolean           @default(true)
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt
  empresa        Empresa           @relation(fields: [empresaId], references: [id], onDelete: Cascade)
  subscription   Subscription?     @relation(fields: [subscriptionId], references: [id])
  subscriptionPayments SubscriptionPayment[]

  @@index([empresaId, isDefault])
  @@map("payment_method")
}

model SubscriptionPayment {
  id                 Int           @id @default(autoincrement())
  empresaId          Int
  subscriptionId     Int
  paymentMethodId    Int?
  wompiTransactionId String?       @db.VarChar(191)
  amount             Decimal       @db.Decimal(10, 2)
  status             PaymentStatus @default(pending)
  paidAt             DateTime?
  errorMessage       String?       @db.Text
  createdAt          DateTime      @default(now())
  updatedAt          DateTime      @updatedAt
  empresa            Empresa       @relation(fields: [empresaId], references: [id], onDelete: Cascade)
  subscription       Subscription  @relation(fields: [subscriptionId], references: [id], onDelete: Cascade)
  paymentMethod      PaymentMethod? @relation(fields: [paymentMethodId], references: [id])

  @@index([empresaId, status, createdAt])
  @@map("subscription_payment")
}

model ConversationPurchase {
  id                 Int           @id @default(autoincrement())
  empresaId          Int
  creditsAmount      Int
  pricePaid          Decimal       @db.Decimal(10, 2)
  wompiTransactionId String?       @db.VarChar(191)
  status             PaymentStatus @default(pending)
  errorMessage       String?       @db.Text
  isApplied          Boolean       @default(false)
  appliedAt          DateTime?
  createdAt          DateTime      @default(now())
  updatedAt          DateTime      @updatedAt
  empresa            Empresa       @relation(fields: [empresaId], references: [id], onDelete: Cascade)

  @@index([empresaId, status])
  @@map("conversation_purchase")
}

model Client {
  id                Int      @id @default(autoincrement())
  empresaId         Int
  name              String
  phone             String
  lastProcedure     String?
  lastProcedureDate DateTime?
  notes             String?  @db.Text
  status            String   @default("active")
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  empresa           Empresa  @relation(fields: [empresaId], references: [id], onDelete: Cascade)

  @@unique([empresaId, phone])
  @@map("client")
}

/**
 * ========== Configuración E-commerce (NUEVO) ==========
 */

model BusinessConfigEcommerce {
  id        Int      @id @default(autoincrement())
  empresaId Int      @unique
  isActive  Boolean  @default(false)
  aiMode    AiMode?  @default(ecommerce)

  // Identidad
  storeName       String?
  currency        String  @default("COP")
  
  // Knowledge Base: Logística (Respuestas IA)
  shippingCost           String? 
  deliveryTimeEstimate   String?
  pickupAddress          String? @db.Text
  
  // Knowledge Base: Pagos (Respuestas IA)
  manualPaymentInfo    String? @db.Text
  
  // Cierre (El 90% Manual)
  aiSellingStyle       String  @default("asesor")
  closingInstructions  String? @db.Text 

  // Políticas
  returnPolicy         String? @db.Text
  warrantyPolicy       String? @db.Text

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  Empresa Empresa @relation(fields: [empresaId], references: [id], onDelete: Cascade)

  @@map("business_config_ecommerce")
}